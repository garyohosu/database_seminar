# 新入社員向けデータベース講座用スライド作成結果

## 講座概要
- **対象**: 新入社員
- **使用データベース**: Microsoft ACCESS
- **講義時間**: 120分（2時間）
- **形式**: 理論説明 + ハンズオン実習

## 1. データベース基礎概念（15分）

### スライド内容
**データベースとは何か**
- データベース（Database）= 「データの基地」
- 構造化されたデータを一定のルールに基づいて整理・保存する仕組み
- 「あらゆる情報が整理されている収納箱」（初心者向け説明）

**データベースの利点**
- 必要な時に必要なデータをすぐに取り出せる
- 大量のデータから効率的に検索可能
- データの整合性を保持
- 複数人でのデータ共有が容易

**身近な活用例**
- 顧客管理ツール（住所、氏名、利用状況）
- 在庫管理システム（各店舗の在庫状況一括管理）
- 電子カルテ（診療記録の素早い参照）
- 社員管理システム（社員情報、部署配属）

## 2. リレーショナルデータベース概念（20分）

### スライド内容
**リレーショナルデータベース（RDB）の特徴**
- 表形式（テーブル）でデータを管理
- 行（レコード）と列（カラム）で構成
- Excelのような2次元表として管理（理解しやすい）
- 複数のテーブル間で関連性を持つ

**基本用語**
- **テーブル**: データを格納する表
- **レコード（行）**: 一つの情報の集合
- **フィールド（列）**: 特定の属性を表す項目

**主キー（プライマリーキー）**
- テーブル内のレコードを一意に識別するフィールド
- 重複してはいけない値
- 例: 社員ID、商品コード、顧客番号

**外部キー**
- 他のテーブルの主キーを参照するカラム
- テーブル間の関連付けを行う
- データの整合性を保つ制約

### 実例: 社員管理システム
```
【社員テーブル】
社員ID | 氏名   | 部署ID
001    | 田中   | D01
002    | 佐藤   | D02

【部署テーブル】
部署ID | 部署名
D01    | 営業部
D02    | 開発部
```

## 3. 正規化の概念と実践（25分）

### スライド内容
**正規化とは**
- データの重複を最小限に抑える設計手法
- データの整合性と効率性を向上
- 冗長なデータを排除してストレージ容量を節約

### 正規化の段階

**第1正規形**
- 各セルに1つの値のみを格納
- 繰り返しグループを別テーブルに分離

**第2正規形**
- 第1正規形を満たす
- 部分関数従属を排除
- 主キーに完全に依存する形に分割

**第3正規形**
- 第2正規形を満たす
- 推移的関数従属を排除
- 非キー属性間の依存関係を解消

### 正規化の実例
**非正規化テーブル（問題のあるデータ）**
```
注文ID | 顧客名 | 顧客住所     | 商品名 | 単価 | 数量
001    | 田中   | 東京都...    | ペン   | 100  | 5
002    | 田中   | 東京都...    | ノート | 200  | 3
```

**正規化後（第3正規形）**
```
【顧客テーブル】
顧客ID | 顧客名 | 住所
C01    | 田中   | 東京都...

【商品テーブル】
商品ID | 商品名 | 単価
P01    | ペン   | 100
P02    | ノート | 200

【注文テーブル】
注文ID | 顧客ID | 商品ID | 数量
001    | C01    | P01    | 5
002    | C01    | P02    | 3
```

## 4. データベースの種類（10分）

### スライド内容
**主要なRDBMS**
- **MySQL**: オープンソース、Web開発で人気
- **PostgreSQL**: 高機能、エンタープライズ向け
- **Microsoft SQL Server**: Windows環境に最適化
- **Oracle Database**: 大企業向け、高性能
- **Microsoft ACCESS**: デスクトップ向け、小規模システム

**NoSQLデータベース**
- **MongoDB**: ドキュメント指向
- **Redis**: キー・バリュー型
- **Cassandra**: カラム指向

**用途別選択基準**
- 小規模・個人用: ACCESS
- Web開発: MySQL, PostgreSQL
- 企業システム: SQL Server, Oracle
- ビッグデータ: NoSQL系

## 5. 基本SQLコマンドとハンズオン（35分）

### 実習用サンプルデータベース設計
**商品管理システム**

```sql
-- テーブル作成
CREATE TABLE 商品 (
    商品ID COUNTER PRIMARY KEY,
    商品名 TEXT(50),
    価格 CURRENCY,
    在庫数 INTEGER
);

CREATE TABLE 顧客 (
    顧客ID COUNTER PRIMARY KEY,
    顧客名 TEXT(50),
    電話番号 TEXT(15)
);

CREATE TABLE 注文 (
    注文ID COUNTER PRIMARY KEY,
    顧客ID INTEGER,
    商品ID INTEGER,
    数量 INTEGER,
    注文日 DATETIME
);
```

### 基本SQLコマンド

**SELECT（データ検索）**
```sql
-- 全データ取得
SELECT * FROM 商品;

-- 特定フィールド取得
SELECT 商品名, 価格 FROM 商品;

-- 条件付き検索
SELECT * FROM 商品 WHERE 価格 > 1000;

-- 並び替え
SELECT * FROM 商品 ORDER BY 価格 DESC;
```

**INSERT（データ挿入）**
```sql
INSERT INTO 商品 (商品名, 価格, 在庫数) 
VALUES ('ボールペン', 150, 100);
```

**UPDATE（データ更新）**
```sql
UPDATE 商品 
SET 価格 = 200 
WHERE 商品名 = 'ボールペン';
```

**DELETE（データ削除）**
```sql
DELETE FROM 商品 
WHERE 在庫数 = 0;
```

### ハンズオン課題
1. 商品テーブルに5件のデータを追加
2. 価格が500円以上の商品を検索
3. 特定商品の在庫数を更新
4. 在庫切れ商品を削除

## 6. C++Builder12からACCESS連携（10分）

### 接続設定
```cpp
// ADO接続文字列
String connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;"
                          "Data Source=C:\\database\\sample.accdb;";

// 接続オブジェクト作成
ADOConnection1->ConnectionString = connectionString;
ADOConnection1->Connected = true;
```

### データ読み取り例
```cpp
// データ取得
ADOQuery1->SQL->Clear();
ADOQuery1->SQL->Add("SELECT * FROM 商品 WHERE 価格 > 1000");
ADOQuery1->Open();

// 結果の処理
while (!ADOQuery1->Eof) {
    String 商品名 = ADOQuery1->FieldByName("商品名")->AsString;
    int 価格 = ADOQuery1->FieldByName("価格")->AsInteger;
    
    // データ表示処理
    Memo1->Lines->Add(商品名 + ": " + IntToStr(価格) + "円");
    
    ADOQuery1->Next();
}
```

### データ書き込み例
```cpp
// データ挿入
ADOQuery1->SQL->Clear();
ADOQuery1->SQL->Add("INSERT INTO 商品 (商品名, 価格, 在庫数) "
                    "VALUES (:name, :price, :stock)");
ADOQuery1->Parameters->ParamByName("name")->Value = "新商品";
ADOQuery1->Parameters->ParamByName("price")->Value = 500;
ADOQuery1->Parameters->ParamByName("stock")->Value = 50;
ADOQuery1->ExecSQL();
```

### エラーハンドリング
```cpp
try {
    ADOConnection1->Connected = true;
    // データベース操作
} catch (Exception &e) {
    ShowMessage("データベース接続エラー: " + e.Message);
}
```

## 7. 講義タイムスケジュール（120分構成）

### 詳細時間配分
| 時間 | 内容 | 形式 |
|------|------|------|
| 0-15分 | データベース基礎概念 | 講義 |
| 15-35分 | リレーショナルデータベース | 講義 |
| 35-60分 | 正規化の理論と実践 | 講義+演習 |
| 60-70分 | **休憩** | - |
| 70-80分 | データベースの種類 | 講義 |
| 80-115分 | SQL実習 | ハンズオン |
| 115-125分 | C++Builder連携 | デモ |
| 125-135分 | 質疑応答・まとめ | 討議 |

### 各セクションの重要ポイント
- **理論**: 概念理解を重視、具体例を多用
- **実習**: 段階的に難易度を上げる
- **デモ**: 実際のコードを動かして見せる
- **Q&A**: 実務での疑問に答える時間を確保

## 8. 講師用ノート

### 準備物
- ACCESS 2019以降がインストールされたPC
- C++Builder 12開発環境
- サンプルデータベースファイル
- 実習用データセット

### 注意点
- 初心者向けなので専門用語の説明を丁寧に
- 実例を豊富に用意し、身近な例で説明
- ハンズオンでは個別サポートを重視
- エラーが発生した場合の対処法を準備

### 追加説明事項
- データベース設計の重要性
- セキュリティ（SQLインジェクション対策）
- バックアップとリストアの重要性
- 実務でのデータベース運用経験談